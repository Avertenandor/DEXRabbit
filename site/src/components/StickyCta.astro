---
// Sticky CTA component for mobile
const telegramBotUrl = "https://t.me/your_bot"; // TODO: Replace with actual bot URL
---

<div id="sticky-cta" class="fixed bottom-0 left-0 right-0 z-40 bg-[var(--bg-primary)] border-t border-[var(--border-primary)] sm:hidden backdrop-blur-md">
  <div class="container">
    <div class="flex items-center justify-center py-3 safe-area-bottom">
      <a
        href={telegramBotUrl}
        class="btn-primary w-full max-w-sm justify-center text-sm"
        target="_blank"
        rel="noopener noreferrer"
        style="padding-bottom: max(0.75rem, env(safe-area-inset-bottom, 0px));"
      >
        Открыть Telegram-бот
      </a>
    </div>
  </div>
</div>

<script>
  let lastScrollTop = 0;
  const stickyCta = document.getElementById('sticky-cta');

  function updateStickyCta() {
    if (!stickyCta) return;

    const scrollTop = window.pageYOffset || document.documentElement.scrollTop;

    // Show CTA when scrolling down, hide when scrolling up
    if (scrollTop > lastScrollTop && scrollTop > 100) {
      // Scrolling down
      stickyCta.style.transform = 'translateY(0)';
      stickyCta.style.opacity = '1';
    } else if (scrollTop < lastScrollTop && scrollTop < window.innerHeight) {
      // Scrolling up and near top
      stickyCta.style.transform = 'translateY(100%)';
      stickyCta.style.opacity = '0';
    }

    lastScrollTop = scrollTop;
  }

  // Initialize
  if (stickyCta) {
    stickyCta.style.transform = 'translateY(100%)';
    stickyCta.style.opacity = '0';
    stickyCta.style.transition = 'transform 0.3s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.3s ease';

    window.addEventListener('scroll', updateStickyCta, { passive: true });
    window.addEventListener('resize', updateStickyCta, { passive: true });

    // Respect reduced motion
    if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
      stickyCta.style.transition = 'none';
    }
  }
</script>

<style>
  .safe-area-bottom {
    padding-bottom: max(1rem, env(safe-area-inset-bottom, 0px));
  }

  .btn-primary {
    background-color: var(--accent-primary);
    color: white;
    padding: 0.75rem 1.5rem;
    border-radius: var(--radius-2xl);
    font-weight: 600;
    font-size: 1rem;
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    border: none;
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    text-decoration: none;
    box-shadow: var(--shadow-md);
  }

  .btn-primary:hover {
    background-color: var(--accent-hover);
    transform: translateY(-1px);
    box-shadow: var(--shadow-lg);
  }

  .btn-primary:active {
    transform: translateY(0);
    box-shadow: var(--shadow-md);
  }
</style>
